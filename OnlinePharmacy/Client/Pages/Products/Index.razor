@page "/products/"
@inject HttpClient _client
@inject IJSRuntime js
@attribute [Authorize]
@using OnlinePharmacy.Shared.Domain



<h3 class="card title">Products</h3>
<br />


@code {
    private List<Product>? Products;

    protected async override Task OnInitializedAsync()
    {
        Products = await _client.GetFromJsonAsync<List<Product>>($"{Endpoints.ProductsEndpoint}");
    }

    async Task Delete(int productId)
    {
        if (Products != null)
        {
            var product = Products.First(q => q.Id == productId);
            var confirm = await js.InvokeAsync<bool>("confirm", $"Do you want to delete {product.Name}?");
            if (confirm)
            {
                await _client.DeleteAsync($"{Endpoints.ProductsEndpoint}/{productId}");
                await OnInitializedAsync();
            }
        }
    }

}
